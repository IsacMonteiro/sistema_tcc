{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"dropdown-list\"\n};\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = {\n  class: \"item-count\"\n};\nconst _hoisted_4 = {\n  class: \"pagination-buttons\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_expand_transition = _resolveComponent(\"v-expand-transition\");\n  const _component_v_col = _resolveComponent(\"v-col\");\n  const _component_v_row = _resolveComponent(\"v-row\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  return _openBlock(), _createBlock(_component_v_container, {\n    class: \"d-flex flex-column align-center gap-4\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_row, {\n      class: \"button-container\",\n      justify: \"center\",\n      align: \"center\"\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.buttons, (item, index) => {\n        return _openBlock(), _createBlock(_component_v_col, {\n          key: index,\n          cols: \"12\",\n          md: \"4\",\n          class: \"mb-4\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_v_btn, {\n            class: \"filter-button\",\n            elevation: \"2\",\n            dark: \"\",\n            onClick: $event => $setup.toggleDropdown(index)\n          }, {\n            default: _withCtx(() => [_createVNode(_component_v_icon, {\n              class: \"me-2\"\n            }, {\n              default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.dropdowns[index] ? 'mdi-minus' : 'mdi-plus'), 1 /* TEXT */)]),\n              _: 2 /* DYNAMIC */\n            }, 1024 /* DYNAMIC_SLOTS */), _createElementVNode(\"span\", null, _toDisplayString(item), 1 /* TEXT */)]),\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_v_expand_transition, null, {\n            default: _withCtx(() => [$setup.dropdowns[index] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.getVisibleItems(index), (option, idx) => {\n              return _openBlock(), _createElementBlock(\"li\", {\n                key: idx,\n                onClick: $event => $setup.goToResults(index, option.text),\n                class: \"dropdown-item\"\n              }, [_createTextVNode(_toDisplayString(option.text) + \" \", 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_3, _toDisplayString(option.count), 1 /* TEXT */)], 8 /* PROPS */, _hoisted_2);\n            }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_4, [$setup.hasPreviousPage(index) ? (_openBlock(), _createBlock(_component_v_btn, {\n              key: 0,\n              onClick: $event => $setup.goToPreviousPage(index),\n              class: \"pagination-button prev-button\"\n            }, {\n              default: _withCtx(() => [...(_cache[0] || (_cache[0] = [_createTextVNode(\" Voltar \")]))]),\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true), $setup.hasNextPage(index) ? (_openBlock(), _createBlock(_component_v_btn, {\n              key: 1,\n              onClick: $event => $setup.goToNextPage(index),\n              class: \"pagination-button next-button\"\n            }, {\n              default: _withCtx(() => [...(_cache[1] || (_cache[1] = [_createTextVNode(\" Próximo \")]))]),\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true)])])) : _createCommentVNode(\"v-if\", true)]),\n            _: 2 /* DYNAMIC */\n          }, 1024 /* DYNAMIC_SLOTS */)]),\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["key","class","_createBlock","_component_v_container","default","_withCtx","_createVNode","_component_v_row","justify","align","_createElementBlock","_Fragment","_renderList","$setup","buttons","item","index","_component_v_col","cols","md","_component_v_btn","elevation","dark","onClick","$event","toggleDropdown","_component_v_icon","_createTextVNode","_toDisplayString","dropdowns","_","_createElementVNode","_component_v_expand_transition","_hoisted_1","getVisibleItems","option","idx","goToResults","text","_hoisted_3","count","_hoisted_2","_hoisted_4","hasPreviousPage","goToPreviousPage","_cache","_createCommentVNode","hasNextPage","goToNextPage"],"sources":["C:\\Users\\Micro\\Music\\sistema_tcc\\aplicacao\\frontend\\src\\components\\lista\\ListaSuspensa.vue"],"sourcesContent":["<template>\r\n  <v-container class=\"d-flex flex-column align-center gap-4\">\r\n    <v-row class=\"button-container\" justify=\"center\" align=\"center\">\r\n      <v-col v-for=\"(item, index) in buttons\" :key=\"index\" cols=\"12\" md=\"4\" class=\"mb-4\">\r\n        <v-btn class=\"filter-button\" elevation=\"2\" dark @click=\"toggleDropdown(index)\">\r\n          <v-icon class=\"me-2\">\r\n            {{ dropdowns[index] ? 'mdi-minus' : 'mdi-plus' }}\r\n          </v-icon>\r\n          <span>{{ item }}</span>\r\n        </v-btn>\r\n\r\n        <v-expand-transition>\r\n          <div v-if=\"dropdowns[index]\" class=\"dropdown-list\">\r\n            <ul>\r\n              <li\r\n                v-for=\"(option, idx) in getVisibleItems(index)\"\r\n                :key=\"idx\"\r\n                @click=\"goToResults(index, option.text)\"\r\n                class=\"dropdown-item\"\r\n              >\r\n                {{ option.text }} \r\n                <span class=\"item-count\">{{ option.count }}</span>\r\n              </li>\r\n            </ul>\r\n\r\n            <div class=\"pagination-buttons\">\r\n              <v-btn v-if=\"hasPreviousPage(index)\" @click=\"goToPreviousPage(index)\" class=\"pagination-button prev-button\">\r\n                Voltar\r\n              </v-btn>\r\n\r\n              <v-btn v-if=\"hasNextPage(index)\" @click=\"goToNextPage(index)\" class=\"pagination-button next-button\">\r\n                Próximo\r\n              </v-btn>\r\n            </div>\r\n          </div>\r\n        </v-expand-transition>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport { useAutorStore } from \"../../store/autorStore\";\r\nimport { useOrientadorStore } from \"../../store/orientadorStore\";\r\nimport { useObraStore } from \"../../store/obraStore\";\r\nimport { useCursoStore } from \"../../store/cursoStore\";\r\nimport { onMounted, ref } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\n\r\nexport default {\r\n  setup() {\r\n    const router = useRouter();\r\n    const autorStore = useAutorStore();\r\n    const orientadorStore = useOrientadorStore();\r\n    const obraStore = useObraStore();\r\n    const cursoStore = useCursoStore();\r\n\r\n    const autores = ref([]);\r\n    const orientadores = ref([]);\r\n    const cursos = ref([]);\r\n    const obras = ref([]);\r\n\r\n    const dropdownOptions = ref([[], [], [], [], [], []]); // Filtros para os dropdowns\r\n\r\n    const buttons = [\r\n      \"Autor\", \"Título\", \"Áreas de Conhecimento - Cursos\", \"Data de Defesa\", \"Orientador\", \"Tipo de Obra\"\r\n    ];\r\n\r\n    const dropdowns = ref([false, false, false, false, false, false]);\r\n    const pages = ref([0, 0, 0, 0, 0, 0]); // Página atual para cada dropdown\r\n    const itemsPerPage = 7;\r\n\r\n    const toggleDropdown = (index) => {\r\n      dropdowns.value[index] = !dropdowns.value[index];\r\n    };\r\n\r\n    const groupAndCountByCustomRelation = (mapFn, items) => {\r\n      const grouped = items.reduce((acc, item) => {\r\n        const key = mapFn(item);\r\n        if (!key) return acc;\r\n        acc[key] = (acc[key] || 0) + 1;\r\n        return acc;\r\n      }, {});\r\n\r\n      return Object.entries(grouped).map(([text, count]) => ({ text, count }));\r\n    };\r\n\r\n    const updateDropdowns = () => {\r\n      dropdownOptions.value[0] = groupAndCountByCustomRelation(\r\n        (obra) => autores.value.find((a) => a.id_autor === obra.fk_id_autor)?.nome_autor || \"Autor Desconhecido\",\r\n        obras.value\r\n      );\r\n      dropdownOptions.value[1] = groupAndCountByCustomRelation(\r\n        (obra) => obra.titulo || \"Título Desconhecido\",\r\n        obras.value\r\n      );\r\n      dropdownOptions.value[2] = groupAndCountByCustomRelation(\r\n        (obra) => cursos.value.find((c) => c.id_curso === obra.fk_id_curso)?.nome_curso || \"Curso Desconhecido\",\r\n        obras.value\r\n      );\r\n      dropdownOptions.value[3] = groupAndCountByCustomRelation(\r\n        (obra) => new Date(obra.data_apresentacao).getFullYear(),\r\n        obras.value\r\n      );\r\n      dropdownOptions.value[4] = groupAndCountByCustomRelation(\r\n        (obra) => orientadores.value.find((o) => o.id_orientador === obra.fk_id_orientador)?.nome_orientador || \"Orientador Desconhecido\",\r\n        obras.value\r\n      );\r\n      dropdownOptions.value[5] = groupAndCountByCustomRelation(\r\n        (obra) => obra.tipo || \"Tipo Desconhecido\",\r\n        obras.value\r\n      );\r\n    };\r\n\r\n    const goToResults = (index, selectedItem) => {\r\n      const filterKey = buttons[index];\r\n\r\n      if (!selectedItem || !filterKey) {\r\n        return;\r\n      }\r\n\r\n      // Navegar para a página de resultados com os parâmetros de filtro\r\n      router.push({\r\n        name: \"SearchPage\",  // Nome da rota da página de resultados\r\n        query: { filterKey, selectedItem }\r\n      }).catch((err) => {\r\n        console.error(\"Erro ao navegar para a rota:\", err);\r\n      });\r\n    };\r\n\r\n    // Função para inverter o nome, colocando o sobrenome primeiro\r\n    const formatName = (name) => {\r\n      if (!name) return '';\r\n      const nameParts = name.split(' ');\r\n      const lastName = nameParts.pop(); // Assume que o sobrenome é a última palavra\r\n      return `${lastName}, ${nameParts.join(' ')}`; // Sobrenome, nome\r\n    };\r\n\r\n    const getVisibleItems = (index) => {\r\n      const start = pages.value[index] * itemsPerPage;\r\n      // Formatar os nomes apenas na exibição\r\n      return dropdownOptions.value[index].map(item => ({\r\n        text: formatName(item.text), // Formatação apenas para exibição\r\n        count: item.count\r\n      })).slice(start, start + itemsPerPage);\r\n    };\r\n\r\n    const hasPreviousPage = (index) => pages.value[index] > 0;\r\n    const hasNextPage = (index) => pages.value[index] * itemsPerPage + itemsPerPage < dropdownOptions.value[index].length;\r\n\r\n    const goToPreviousPage = (index) => {\r\n      if (pages.value[index] > 0) pages.value[index]--;\r\n    };\r\n\r\n    const goToNextPage = (index) => {\r\n      if (pages.value[index] * itemsPerPage + itemsPerPage < dropdownOptions.value[index].length) pages.value[index]++;\r\n    };\r\n\r\n    onMounted(async () => {\r\n      try {\r\n        await autorStore.listarAutores();\r\n        autores.value = autorStore.autores;\r\n\r\n        await orientadorStore.listarOrientadores();\r\n        orientadores.value = orientadorStore.orientadores;\r\n\r\n        await obraStore.listarObras();\r\n        obras.value = obraStore.obras;\r\n\r\n        await cursoStore.listarCursos();\r\n        cursos.value = cursoStore.cursos;\r\n\r\n        updateDropdowns();\r\n      } catch (error) {\r\n        console.error(\"Erro ao carregar dados:\", error);\r\n      }\r\n    });\r\n\r\n    return {\r\n      autores,\r\n      orientadores,\r\n      cursos,\r\n      obras,\r\n      dropdownOptions,\r\n      buttons,\r\n      dropdowns,\r\n      toggleDropdown,\r\n      goToResults,\r\n      getVisibleItems,\r\n      hasPreviousPage,\r\n      hasNextPage,\r\n      goToPreviousPage,\r\n      goToNextPage,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.button-container {\r\n  margin-top: 20px;\r\n}\r\n\r\n.filter-button {\r\n  width: 100%;\r\n  background-color: #00420c;\r\n  color: #fff;\r\n  height: 50px;\r\n  text-transform: none;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  border-radius: 10px;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  padding: 0 16px;\r\n  width: 1000px;\r\n}\r\n\r\n.filter-button:hover {\r\n  background-color: #001a05;\r\n}\r\n\r\n.dropdown-list {\r\n  background: #e0f2f1;\r\n  border-radius: 8px;\r\n  padding: 8px 16px;\r\n  margin-top: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.dropdown-list ul {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\n.dropdown-item {\r\n  font-size: 14px;\r\n  margin-bottom: 4px;\r\n  color: #004d40;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 8px 12px;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s;\r\n}\r\n\r\n.dropdown-item:hover {\r\n  background-color: #00420c;\r\n  color: #fff;\r\n}\r\n\r\n.dropdown-item:active {\r\n  background-color: #002a06;\r\n  transform: scale(0.95);\r\n}\r\n\r\n.pagination-buttons {\r\n  margin-top: 12px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.pagination-button {\r\n  margin-top: 10px;\r\n}\r\n\r\n.prev-button {\r\n  background-color: #00420c;\r\n  color: white;\r\n}\r\n\r\n.prev-button:hover {\r\n  background-color: #001a05;\r\n}\r\n\r\n.next-button {\r\n  background-color: #00420c;\r\n  color: white;\r\n}\r\n\r\n.next-button:hover {\r\n  background-color: #001a05;\r\n}\r\n\r\n.item-count {\r\n  font-weight: bold;\r\n  color: #00796b;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}